<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>proyecto_munoz_dediego</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Proyecto_munoz_dediego_files/libs/clipboard/clipboard.min.js"></script>
<script src="Proyecto_munoz_dediego_files/libs/quarto-html/quarto.js"></script>
<script src="Proyecto_munoz_dediego_files/libs/quarto-html/popper.min.js"></script>
<script src="Proyecto_munoz_dediego_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Proyecto_munoz_dediego_files/libs/quarto-html/anchor.min.js"></script>
<link href="Proyecto_munoz_dediego_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Proyecto_munoz_dediego_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Proyecto_munoz_dediego_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Proyecto_munoz_dediego_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Proyecto_munoz_dediego_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="el-cine-en-7-gráficos" class="level1 title">
<h1 class="title">El cine en 7 gráficos</h1>
<section id="fco.-javier-muñoz-y-jorge-de-diego" class="level4 author">
<h4 class="author anchored" data-anchor-id="fco.-javier-muñoz-y-jorge-de-diego">Fco. Javier Muñoz y Jorge de Diego</h4>
<p>Según Alfred Hitchcock, el cine consiste tan sólo en contar una historia. Una definición sencilla, pero llena de matices: tenemos historias buenas y malas; de llorar, reír y todo lo que hay en medio; historias caras y baratas, que ganan o pierden dinero; también largas y cortas. Para explorar todo ello, hemos reunido datos de más de 6000 películas, las más populares (según IMDB) desde 1985 y condensamos esa información en 7 gráficos clave y una sorpresa. Empecemos.</p>
<p>Todos sabemos que la industria del cine es un sector donde hay mucho dinero en juego; no es barato hacer una película, pero tampoco ir al cine ¿esto ha sido siempre así? En el cine actual los efectos especiales juegan un rol fundamental y la tecnología es mucho más sofisticada, por lo que podría parecer que el cine ahora es más caro. Además, la asistencia al cine es cada vez menor, lo que podría implicar menores ingresos.</p>
<iframe title="Los beneficios del cine están en constante auge" aria-label="Interactive line chart" id="datawrapper-chart-bq6vZ" src="https://datawrapper.dwcdn.net/bq6vZ/6/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="404" data-external="1">
</iframe>
<script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script>
<p>Al observar la evolución del presupuesto de las películas y de los ingresos generados en taquilla, con la inflación ajustada, vemos precisamente lo contrario. Mientras que la inversión y coste de las películas se ha mantenido más o menos estable, los ingresos se han disparado. Es decir, si los costes se mantienen pero la retribución es mayor, es evidente que el cine hoy en día es más rentable que hace 20 años.</p>
<p>Cuando se ve esta tendencia hacia los beneficios surge la pregunta de si habrá sido generalizada entre todos los tipos de películas o si algunos géneros han aumentado sus beneficios mucho más que otros. Al observar pormenorizadamente parece que efectivamente ha sido una tendencia compartida, aunque es cierto que géneros como la animación, el terror o la aventura han tenido esta inclinación ascendente algo más moderada.</p>
<p><img src="https://i.gyazo.com/06eea73dedf544f42052b496589e64bb.png" class="img-fluid"></p>
<p>Ahora bien, para observar acertadamente la cuestión de la rentabilidad, lo mejor es ver los beneficios obtenidos por cada película, esto es, ver la relación entre ingresos y costes de cada largometraje. Quizás, más presupuesto no suponga siempre más ingresos y películas de bajo coste hayan podido obtener elevados beneficios.</p>
<iframe title="La mayoría de películas son rentables" aria-label="Diagrama de dispersión" id="datawrapper-chart-K5gYV" src="https://datawrapper.dwcdn.net/K5gYV/3/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="453" data-external="1">
</iframe>
<script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script>
<p>Esto es lo que se ve precisamente en el gráfico, aunque es cierto que la mayoría de películas son rentables, ingresan más de lo que costaron. Al deslizar el ratón sobre los géneros se puede ver cómo se agrupan en rentabilidad, destacando el género de acción. De hecho, al clickar sobre los puntos se puede ver la película y los beneficios o pérdidas específicas.</p>
<p>Aquí hay interesantes casos, por ejemplo Avatar es la película que más beneficios ha conseguido, pero tuvo una inversión millonaria. En cambio, Paranormal Activity consiguió unos ingresos muy importantes con una inversión mínima: 15.000 dólares.</p>
<p>¿El hecho de que una película tenga muchos beneficios la hace mejor? Mucha gente puede ir a ver algo al cine y que luego, o bien no le guste, o bien tenga un carácter más comercial y sea menos atractiva para los eruditos del séptimo arte. Por ello, hay que atender a cómo se relacionan estas cuestiones.</p>
<iframe title="Las películas con más beneficios tienen mejor puntuación" aria-label="Diagrama de dispersión" id="datawrapper-chart-FE9lv" src="https://datawrapper.dwcdn.net/FE9lv/10/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="445" data-external="1">
</iframe>
<script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script>
<p>Pues bien, parece claro que a más beneficios obtenga un largometraje más difícil será que el público le ponga una nota de suspenso. Es cierto que hay excepciones a observar cuando se interactúa con los puntos, por ejemplo las películas de la saga Crepúsculo (excepto la primera), que a pesar de tener unos beneficios interesantes, suspenden o aprueban por la mínima.</p>
<p>Igual que con la rentabilidad, es interesante ver cómo se puntúan las películas según el género de estas, ¿a los espectadores nos parecen mejor películas de un tipo u otro?</p>
<p><img src="https://i.gyazo.com/b5f2cb4cea3974367da73b4115087d24.png" class="img-fluid"></p>
<p>Parece que los largometrajes biográficos o los hacen muy bien o nos gustan mucho, o ambas. Tan solo una película de este género suspende. Igualmente, parece que el terror o no se hace bien, o el miedo nos hace ponerle una puntuación peor: es la categoría con peor nota media.</p>
<p>Otro de los temas que nos trae de cabeza a la hora de elegir qué película ver es la duración. Está claro que no buscamos lo mismo un martes después de cenar, cuando tenemos que madrugar al día siguiente, y una tarde de sábado sin nada mejor que hacer que pasar 5h viendo “Novecento”. Ahora bien, ¿nos dejan mejor recuerdo las primeras o las segundas?</p>
<iframe title="Las películas (muy) largas son mejor valoradas" aria-label="Diagrama de dispersión" id="datawrapper-chart-B8WKa" src="https://datawrapper.dwcdn.net/B8WKa/10/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="563" data-external="1">
</iframe>
<script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script>
<p>Si nos fijamos sólo en la duración, parece que disfrutamos más aquellas que nos dejan pegados al sofá más tiempo. Y eso está bien, pero no debemos dejar de pensar que estas notas son valoraciones de usuarios, por lo que es posible que haya un sesgo que nos hace inspeccionar mucho mejor las películas que sabemos que son más largas. Es decir, conocemos que el coste de ver una película mala se multiplica por la duración, lo que tal vez nos hace ser más selectivos con las que empiezan a pasar de las 2h.</p>
<p>A la vez, se abre otro melón, ¿es la duración algo haya cambiado con el tiempo? Desde que tenemos las plataformas digitales, es indudable que el contenido se consume de forma distinta, alejándonos un poco de las salas de cine.</p>
<iframe title="La duración de nuestras favoritas no ha cambiado mucho con el tiempo" aria-label="Gráfico de columnas" id="datawrapper-chart-u8l2A" src="https://datawrapper.dwcdn.net/u8l2A/6/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="438" data-external="1">
</iframe>
<script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script>
<p>Los datos nos muestran que, de media, nuestra película favorita tiene unos 137 minutos de duración. Analizando esta media, vemos que no hay una tendencia clara: tendríamos que irnos hasta 2013 para ver una ruptura de más de 10 minutos con respecto a ella.</p>
<p>Pasando del tiempo al espacio, está claro que el mundo del cine está terriblemente occidentalizado. Para verlo mejor, comprobemos primero de dónde son las películas más populares. En el mismo mapa podemos seleccionar distintas etapas de nominaciones a mejor película extranjera, un buen baremo para comprobar este sesgo.</p>
<iframe title="Se hace mucho más cine en Norte América y Europa" aria-label="Mapa" id="datawrapper-chart-nr8eb" src="https://datawrapper.dwcdn.net/nr8eb/12/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="662" data-external="1">
</iframe>
<script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script>
<p>Si bien parece indiscutible la concentración europea, la tendencia del último período (2006-2023) nos muestra que las cosas están cambiando. Ya no es Francia (ni el trío conformado por esta, Italia y España) sino Dinamarca (también un país europeo) el que encabeza las nominaciones. Por otro lado, en la misma etapa, encontramos hasta 10 nominaciones en Oriente Medio, mientras que en la anterior, aun siendo más larga, tan sólo veíamos 2.</p>
<p>Esto tal vez sea una evidencia más de que la globalización penetra en la mayoría de los aspectos cotidianos de la vida, y es que, aunque las nominaciones son llevadas a cabo por los académicos de cine, parece claro que tener más mercado para las películas de países pequeños incentiva más producciones y en último término esto hace que su contenido pueda mejorar.</p>
<p>Por último, como sabemos que el cine depende también de nombres, hemos agrupado a los directores más influyentes desde 1985 con algunos datos interesantes. Por ejemplo, vemos que Spielberg es el director que más beneficios ha generado, aunque ojo, porque Anthony Russo con 19 producciones menos está en segundo puesto. Si haces click en la lupa, puedes buscar a tu director o directora fetiche (¡siempre que haya dirigido a partir de 1985!)</p>
<iframe title="¿Cómo lo ha hecho tu director/a favorito/a?" aria-label="Tabla" id="datawrapper-chart-MQtWs" src="https://datawrapper.dwcdn.net/MQtWs/7/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="431" data-external="1">
</iframe>
<script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script>
<p>Este es el resumen de casi 5 décadas de cine, una industria en la que parece que es cada vez más fácil hacer dinero. Más allá de la vacuidad de Marvel o la pretenciosidad del cine de autor, el cine es un arte. Un arte que si bien está sometido a la óptica económica, salta cada vez más las fronteras de los países. Porque en definitiva, recordamos que se trata tan sólo de contar una historia, y eso se logra en cualquier parte.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>